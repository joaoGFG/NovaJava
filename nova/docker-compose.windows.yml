services:
  # Spring Boot Application - Windows Container
  nova-app:
    build:
      context: .
      dockerfile: Dockerfile.windows
    container_name: nova-spring-app-windows
    ports:
      - "8000:8000"
    environment:
      # Spring Boot port
      - SERVER_PORT=8000

      # Database Configuration (usando Oracle da FIAP na nuvem)
      - SPRING_DATASOURCE_URL=${DB_URL:-jdbc:oracle:thin:@oracle.fiap.com.br:1521/ORCL}
      - SPRING_DATASOURCE_USERNAME=${DB_USERNAME:-rm560077}
      - SPRING_DATASOURCE_PASSWORD=${DB_PASSWORD:-300903}
      - SPRING_DATASOURCE_DRIVER_CLASS_NAME=oracle.jdbc.OracleDriver

      # JPA/Hibernate Configuration
      - SPRING_JPA_HIBERNATE_DDL_AUTO=update
      - SPRING_JPA_DATABASE_PLATFORM=org.hibernate.dialect.OracleDialect
      - SPRING_JPA_SHOW_SQL=true
      - SPRING_JPA_PROPERTIES_HIBERNATE_FORMAT_SQL=true

      # RSA Keys (usando as do projeto)
      - RSA_PRIVATE_KEY=classpath:certs/private_key.pem
      - RSA_PUBLIC_KEY=classpath:certs/public_key.pem

      # Logging
      - LOGGING_LEVEL_ORG_SPRINGFRAMEWORK_SECURITY=DEBUG
      - LOGGING_LEVEL_ORG_SPRINGFRAMEWORK=DEBUG

    restart: unless-stopped

    # Windows container specific settings
    isolation: process
